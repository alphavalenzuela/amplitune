<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What's Up</title>
    <link rel="stylesheet" href="styles/listener-homepage.css">
    <link rel="stylesheet" href="styles/index.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Montserrat:wght@700;800&family=Poppins:wght@700;800&display=swap" rel="stylesheet">

    <style>
        button {
        cursor: pointer;
        border: none;
        outline: none;
        font-weight: 600;
        transition: all 0.3s ease;
        padding-left: 2rem;
        padding-right: 2rem;
        }

        .nav-button.post-button {
        padding: 0.5rem 1rem;
        background-color: var(--color-secondary);
        color: var(--color-text);
        border-radius: 50px;
        }
    </style>
</head>
<body>
    <div class="body-container">
        <img src="styles/GradientMesh_Light.png" alt="Background Gradient" class="background">
    </div>

    <div class="content" style="padding-top: 100px;">
        <nav id="navbar">
            <div class="container">
                <div class="logo" style="display: inline-block;">
                    <a href="artist-homepage.html#feed-section" style="display: inline-block;">Ampli<span class="gradient-text">Tune</span></a>
                </div>
                <div class="menu-toggle" id="menu-toggle">
                    <i class="fas fa-bars"></i>
                </div>
                <ul class="nav-links" id="nav-links">
                    <li><a href="#hero">Home</a></li>
                    <li><a href="#analytics">Analytics</a></li>
                    <li><a href="#events">Events</a></li>
                    <li><a href="#feed-section">Feed</a></li>
                    <li><a href="artist-newpost.php" class="nav-button post-button">Create New Post</a></li>

                    <!-- Profile Icon -->
                    <li>
                        <a href="artist-profile.html" class="icon-link" title="Profile">
                            <i class="fa-solid fa-user-circle"></i>
                        </a>
                    </li>

                    <!-- Settings Dropdown -->
                    <li class="settings-dropdown">
                        <div class="settings-icon icon-link" tabindex="0">
                            <i class="fa-solid fa-gear"></i>
                        </div>
                        <div class="dropdown-menu" aria-hidden="true">
                            <a href="user-settings.php">Profile Settings</a>
                            <form method="POST" action="logout.php" style="margin:0;">
                                <button type="submit" class="logout-btn">Logout</button>
                            </form>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>

        <main class="container">

            <div class="page-header" style="font-size: 16px;">
                <h2>Recent Updates From Artists</h2>
            </div>

            <div class="post" data-post-title="üåª &quot;damdamin!&quot; out now! üåª"
                  data-post-image="https://res.cloudinary.com/dfwt0zxdu/image/upload/v1747738311/damdamin_jlkaco.jpg"
                  data-post-artist="Syd Hartha"
                  data-post-date="November 24, 2023"
                  data-full-post-text="si &quot;damdamin!&quot; ay isang kantang tungkol sa ligaya at pagmamahal, sa paglimot sa mga takot, at pagtanggap sa sarili. Isang paglalakbay na sumasalamin sa karanasan ng maraming kabataang Pilipino ngayon. Sa bawat nota, binibigyang-buhay ni Syd Hartha ang bawat damdamin, na nagpapakita ng kanyang kahusayan sa pagsulat ng musika."
                data-youtube-link="https://youtu.be/MMW-S76YGBw?feature=shared"
                data-spotify-link="https://open.spotify.com/track/6nrGNaUnAtLTbXMW4k9kKE?si=1a4d1fd511ae4f72"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 

                  <img src="https://res.cloudinary.com/dfwt0zxdu/image/upload/v1747738311/damdamin_jlkaco.jpg" alt="üåª 'damdamin!' out now! üåª" class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">üåª "damdamin!" out now! üåª</h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">Syd Hartha - November 24, 2023</p>
                      <p class="post-text">si "damdamin!" ay isang kantang tungkol sa ligaya at pagmamahal...</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read more</a> <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 243
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 44
                              </span>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="post" data-post-title="New look and releases single ‚ÄúSmall Talk‚Äù"
                  data-post-image="https://res.cloudinary.com/dfwt0zxdu/image/upload/v1747753753/one-click-straight_cfeipt.jpg"
                  data-post-artist="One Click Straight"
                  data-post-date="December 3, 2023"
                  data-full-post-text="‚ÄòSmall Talk‚Äô is about the frequent situation you find yourself in when you‚Äôre talking to the person you want to get to know. It‚Äôs depicts the desperation a person is willing to go through for a glimpse of something more,‚Äù the band says about the track, which follows the release of 'Pati Ba Pintig ng Puso?,' a collaboration between One Click Straight and the legendary rap icon, Gloc-9."
                  data-youtube-link="https://youtu.be/hN3a-WASsPE?si=h-RdxnmjbrLRMfg5"
                data-spotify-link="https://open.spotify.com/track/567qvRNYXM91sk7C6Qaf4B?si=b1ab58ca5427463e"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 
                  <img src="https://res.cloudinary.com/dfwt0zxdu/image/upload/v1747753753/one-click-straight_cfeipt.jpg" alt="New Sticker Designs!" class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">New look and releases single ‚ÄúSmall Talk‚Äù</h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">One Click Straight - December 3, 2023</p>
                      <p class="post-text">‚ÄòSmall Talk‚Äô is about the frequent situation you find yourself in when you‚Äôre talking to the person you want to get to know. It‚Äôs depicts the desperation a person is willing to go through for a glimpse of something more,‚Äù the band says about the track...</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read more</a>
                          <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 157
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 24
                              </span>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="post" data-post-title="Announces single called ‚ÄòCvnty‚Äô"
                  data-post-image="https://i.scdn.co/image/ab67616d0000b273ba1213f07eb87fe245a85f01"
                  data-post-artist="Stef Aranas"
                  data-post-date="June 13, 2024"
                  data-full-post-text="The song 'Cvnty' is about empowering queer people, especially femmes, and embracing femininity. I want my music to empower my listeners, particularly with this release. The song aims to celebrate femininity in all shapes and forms, especially within the queer community. It‚Äôs a very personal song, reflecting my identity as a queer femme artist, and I hope it resonates with others in their journey of self-acceptance and empowerment."
                  data-youtube-link="https://youtu.be/caJWkdfcQPo?si=QFn3MkUdccwCT9X_"
                data-spotify-link="https://open.spotify.com/track/0AI5NLBfgApsN41hUzXssN?si=73a1201664e44810"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 
                  <img src="https://i.scdn.co/image/ab67616d0000b273ba1213f07eb87fe245a85f01" alt="Cvnty - Stef Aranas " class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">Announces single called ‚ÄòCvnty‚Äô</h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">Stef Aranas - June 13, 2024</p>
                      <p class="post-text">The song "Cvnty" is about empowering queer people, especially femmes, and embracing femininity. I want my music to empower my listeners, particularly with this release. The song aims to celebrate femininity in all shapes and forms, especially within the queer community....</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read More</a>
                          <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 429
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 34
                              </span>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="post" data-post-title="‚ú® &apos;Pantropiko&apos; Music Video Out Now! ‚ú®"
                  data-post-image="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748428/BTY_Beauty-and-BINI_cover-image-1_isxpts.jpg"
                  data-post-artist="BINI"
                  data-post-date="May 15, 2024"
                  data-full-post-text="Our new music video for &apos;Pantropiko&apos; is finally here! This song is about embracing your true self and loving who you are. We put so much love and effort into this, and we hope you enjoy it as much as we enjoyed making it."
                  data-youtube-link="https://youtu.be/SdPcJB4a1Bo?si=rVkCAbWleG0D_G9j"
                data-spotify-link="https://open.spotify.com/track/6Csrqur3IfnVp0EtHskjMw?si=6ee75f1373454e84"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 
                  <img src="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748428/BTY_Beauty-and-BINI_cover-image-1_isxpts.jpg" alt="Pantropiko - BINI " class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">‚ú® &apos;Pantropiko&apos; Music Video Out Now! ‚ú®</h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">BINI - May 15, 2024</p>
                      <p class="post-text">Our new music video for &apos;Pantropiko&apos; is finally here! This song is about embracing your true self and loving who you are.</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read More</a>
                          <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 929
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 234
                              </span>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="post" data-post-title="&apos;Moonlight&apos; World Tour Announcement "
                  data-post-image="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748620/MERec0f27b3f4f2aa7d233bfc0a32243_wyat1116-1365x2048_h7tegp.jpg"
                  data-post-artist="SB19"
                  data-post-date="April 28, 2024"
                  data-full-post-text="
                    We're thrilled to announce our &apos;Moonlight&apos; World Tour! This is our biggest tour yet, with stops in North America, Europe, and Asia.
                    Pre-sale tickets for A'TIN members start next week. General sale begins the week after. 
                    See you on the road, A'TIN!"
                    data-youtube-link="https://youtu.be/_WIGlfguVTs?si=uspyBYqObHzNpt9E"
                data-spotify-link="https://open.spotify.com/track/1xAYG31LamC5qlykRhbWxd?si=0400c5946f764b5a"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 
                  <img src="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748620/MERec0f27b3f4f2aa7d233bfc0a32243_wyat1116-1365x2048_h7tegp.jpg" alt="Pantropiko - BINI " class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">&apos;Moonlight&apos; World Tour Announcement </h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">SB19 - April 28, 2024</p>
                      <p class="post-text">Pre-sale tickets for A'TIN members start next week. General sale begins the week after.</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read More</a>
                          <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 529
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 134
                              </span>
                          </div>
                      </div>
                  </div>
              </div>

              <div class="post" data-post-title="&apos;Autumn&apos; - Our New Single Out Now "
                  data-post-image="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748849/content_rsz_ben_ben_2021_apr_a_roema9.jpg"
                  data-post-artist="Ben&Ben"
                  data-post-date="March 10, 2024"
                  data-full-post-text="
                    &apos;Autumn&apos; is a song about change, growth, and the beauty of letting go. We wrote this during a particularly transformative period in our lives, and we hope it resonates with you too.
                    The music video was shot in Sagada, and features the breathtaking landscapes of the Cordilleras. 
                    Stream &apos;Autumn&apos; now on all platforms!"
                    data-youtube-link="https://youtu.be/j08M79Dbk4o?si=3avpFazxkFb0JXJm"
                data-spotify-link="https://open.spotify.com/track/6opdgT1roU2ztb2WmXQG1U?si=2dd4f6f83a5b439c"
                data-audio-preview="audios/syd hartha - damdamin! [Official Music Video]-[Trimmed by Rev.com].mp3"> 
                  <img src="https://res.cloudinary.com/dxkeh8toc/image/upload/v1747748849/content_rsz_ben_ben_2021_apr_a_roema9.jpg" alt="Pantropiko - BINI " class="post-img">
                  <div class="post-content">
                      <div class="post-header">
                          <h3 class="post-title">&apos;Autumn&apos; - Our New Single Out Now </h3>
                          <span class="post-tag">New Post</span>
                      </div>
                      <p class="post-meta">Ben&Ben - March 10, 2024</p>
                      <p class="post-text">&apos;Autumn&apos; is a song about change, growth, and the beauty of letting go. We wrote this during a particularly transformative period in our lives, and we hope it resonates with you too.</p>
                      <div class="post-footer">
                          <a href="#" class="post-link open-post-modal">Read More</a>
                          <div class="post-stats">
                              <span class="post-stat">
                                  <i class="fa-regular fa-heart"></i> 1229
                              </span>
                              <span class="post-stat share-button" data-url="URL_HERE">
                                  <i class="bi bi-share"></i> 834
                              </span>
                          </div>
                      </div>
                  </div>
              </div>
            </section>

            <div id="postModal" class="modal">
                <div class="modal-content">
                    <span class="close-button" id="closePostModalBtn">√ó</span>
                    <div class="modal-body post-modal-body">
                        <img id="modalPostImage" src="" alt="Post Image" class="modal-post-img">
                        <div class="modal-text-content">
                            <h2 id="modalPostTitle"></h2>
                            <p id="modalPostMeta"></p>
                            <p id="modalPostDescription"></p>

                            <div class="full-listen-links">
                                <p>Listen to the full song:</p>
                                <div class="song-platforms" id="modalPlatformLinks">
                                <a href="https://youtu.be/0aNLFlFFKpw?feature=shared" target="_blank" aria-label="YouTube"><i class="fa-brands fa-youtube platform-icon"></i></a>
                                <a href="https://open.spotify.com/track/06IkOr83qPqa3yYvrIjgxp?si=e74c7341b85741af" target="_blank" aria-label="Spotify"><i class="fa-brands fa-spotify platform-icon"></i></a>
                                </div>
                            </div>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div id="newReleaseModal" class="modal">
            <div class="modal-content">
                <span class="close-button">&times;</span>
                <div class="modal-body">
                    <img id="modalSongImage" src="" alt="Song Artwork" class="modal-song-img">
                    <div class="modal-text-content">
                        <h2 id="modalSongTitle"></h2>
                        <p id="modalSongArtist"></p>
                        <p id="modalSongDescription"></p>

                        <div class="custom-audio-player-container"> 
                          <audio class="audio-element" src="" id="modalAudioPreview"></audio> 
                          <div class="controls-wrapper">
                            <button class="play-pause-btn"><i class="fas fa-play"></i></button>
                            <div class="progress-bar-container">
                              <div class="progress-bar"></div>
                            </div>
                            <span class="time-display">0:00 / 0:00</span>
                            <div class="volume-container">
                              <i class="fas fa-volume-up volume-icon"></i>
                              <input type="range" class="volume-slider" min="0" max="1" step="0.01" value="1">
                            </div>
                          </div>

                          <div class="full-listen-links">
                            <p>Listen to the full song:</p>
                            <div class="song-platforms" id="modalPlatformLinks">
                              <a href="https://youtu.be/0aNLFlFFKpw?feature=shared" target="_blank" aria-label="YouTube"><i class="fa-brands fa-youtube platform-icon"></i></a>
                              <a href="https://open.spotify.com/track/06IkOr83qPqa3yYvrIjgxp?si=e74c7341b85741af" target="_blank" aria-label="Spotify"><i class="fa-brands fa-spotify platform-icon"></i></a>
                            </div>
                          </div>
                        </div>

                        <!-- <div class="modal-platforms">
                            <h3>Listen on:</h3>
                            <div id="modalPlatformLinks" class="song-platforms">
                                </div>
                        </div> -->
                    </div>
                </div>
            </div>
        </div>
        <!-- Footer -->
  <footer class="footer">
        <div class="footer-container">
            <div class="footer-left">
                <div class="logo">
                    <a href="#">Ampli<span class="gradient-text">Tune</span></a>
                </div>
                <p class="footer-description">Discover and support the growing indie music scene in the Philippines.</p>
                <div class="social-links">
                    <a href="#" class="social-link">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="social-link">
                      <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="social-link">
                        <i class="fab fa-instagram"></i>
                    </a>
                </div>
            </div>

            <div class="footer-right">
                <h4 class="footer-heading">Want to know more?</h4>
                <ul class="footer-links">
                    <li><a href="AboutUs/AboutUs.html">About Us</a></li>
                    <li><a href="AboutUs/AboutUs.html#contact">Contact Us</a></li>
                    <li><a href="#">Privacy Policy</a></li>
                    <li><a href="#">Copyright Info</a></li>
                </ul>
            </div>

            <div class="footer-bottom">
                <p class="footer-copyright">&copy; 2025 Amplitune. All rights reserved.</p>
            </div>
        </div>
    </footer>
    </div>

    <script src="functions/index.js"></script>

    <script>
        function scrollArtists(direction) {
            const container = document.querySelector('.artist-scroll');
            const scrollAmount = 300; 
            
            container.scrollBy({
                left: direction * scrollAmount,
                behavior: 'smooth'
            });
        }
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Toggle mobile menu
            const menuToggle = document.getElementById('menu-toggle');
            const navLinks = document.getElementById('nav-links');

            if (menuToggle && navLinks) {
                menuToggle.addEventListener('click', () => {
                    navLinks.classList.toggle('active');
                });
            }

            // Settings dropdown functionality
            const settingsIcon = document.querySelector('.settings-icon');
            const dropdownMenu = document.querySelector('.dropdown-menu');

            if (settingsIcon && dropdownMenu) {
                settingsIcon.addEventListener('click', () => {
                    const isExpanded = settingsIcon.getAttribute('aria-expanded') === 'true';
                    settingsIcon.setAttribute('aria-expanded', !isExpanded);
                    dropdownMenu.setAttribute('aria-hidden', isExpanded);
                    dropdownMenu.classList.toggle('show');
                });

                // Close dropdown when clicking outside
                document.addEventListener('click', (event) => {
                    if (!settingsIcon.contains(event.target) && !dropdownMenu.contains(event.target)) {
                        settingsIcon.setAttribute('aria-expanded', 'false');
                        dropdownMenu.setAttribute('aria-hidden', 'true');
                        dropdownMenu.classList.remove('show');
                    }
                });
            }

            // --- Modal Logic ---
    const newReleaseCards = document.querySelectorAll('.new-release-card');
    const modal = document.getElementById('newReleaseModal');
    const modalContent = modal.querySelector('.modal-content');
    const closeModalBtn = document.querySelector('.close-button');

    const modalSongImage = document.getElementById('modalSongImage');
    const modalSongTitle = document.getElementById('modalSongTitle');
    const modalSongArtist = document.getElementById('modalSongArtist');
    const modalSongDescription = document.getElementById('modalSongDescription');
    const modalPlatformLinks = document.getElementById('modalPlatformLinks');

    // Get references for the custom audio player elements within the modal
    // NOW USING THE ID YOU ADDED
    const modalAudioElement = document.getElementById('modalAudioPreview');
    const modalAudioPlayerContainer = modalAudioElement.closest('.custom-audio-player-container'); // Find the parent container
    
    // Ensure these are selected AFTER the modalAudioElement is defined
    const playPauseBtn = modalAudioPlayerContainer.querySelector('.play-pause-btn');
    const progressBarContainer = modalAudioPlayerContainer.querySelector('.progress-bar-container');
    const progressBar = modalAudioPlayerContainer.querySelector('.progress-bar');
    const timeDisplay = modalAudioPlayerContainer.querySelector('.time-display');
    const volumeSlider = modalAudioPlayerContainer.querySelector('.volume-slider');
    const volumeIcon = modalAudioPlayerContainer.querySelector('.volume-icon');


    newReleaseCards.forEach(card => {
        card.addEventListener('click', (event) => {
            event.preventDefault(); // Prevent default link behavior

            // Pause any currently playing audio on the page
            document.querySelectorAll('audio').forEach(otherAudio => {
                if (otherAudio !== modalAudioElement && !otherAudio.paused) {
                    otherAudio.pause();
                    const otherPlayPauseBtn = otherAudio.closest('.custom-audio-player-container')?.querySelector('.play-pause-btn');
                    if (otherPlayPauseBtn) {
                        otherPlayPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    }
                }
            });

            // Populate modal content from data attributes
            modalSongImage.src = card.dataset.image;
            modalSongTitle.textContent = card.dataset.title;
            modalSongArtist.textContent = card.dataset.artist;
            modalSongDescription.textContent = card.dataset.description;

            // Clear previous platform links
            modalPlatformLinks.innerHTML = '';

            // Add YouTube link if available
            if (card.dataset.youtubeLink && card.dataset.youtubeLink !== 'YOUR_SABIK_YOUTUBE_LINK_HERE') {
                const youtubeLink = document.createElement('a');
                youtubeLink.href = card.dataset.youtubeLink;
                youtubeLink.target = '_blank';
                youtubeLink.setAttribute('aria-label', 'Listen on YouTube');
                youtubeLink.innerHTML = '<i class="fa-brands fa-youtube platform-icon"></i>';
                modalPlatformLinks.appendChild(youtubeLink);
            }

            // Add Spotify link if available
            if (card.dataset.spotifyLink && card.dataset.spotifyLink !== 'YOUR_SABIK_SPOTIFY_LINK_HERE') {
                const spotifyLink = document.createElement('a');
                spotifyLink.href = card.dataset.spotifyLink;
                spotifyLink.target = '_blank';
                spotifyLink.setAttribute('aria-label', 'Listen on Spotify');
                spotifyLink.innerHTML = '<i class="fa-brands fa-spotify platform-icon"></i>';
                modalPlatformLinks.appendChild(spotifyLink);
            }

            // Handle audio preview
            if (card.dataset.audioPreview) {
                modalAudioElement.src = card.dataset.audioPreview;
                modalAudioElement.load(); // Load the new audio source
                modalAudioPlayerContainer.classList.remove('hidden'); // Show the audio player
                // Reset play/pause button and time display for new song
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                progressBar.style.width = '0%';
                timeDisplay.textContent = '0:00 / 0:00';
                modalAudioElement.currentTime = 0; // Reset playback position
            } else {
                modalAudioPlayerContainer.classList.add('hidden'); // Hide if no preview
                modalAudioElement.pause();
                modalAudioElement.src = ''; // Clear source to prevent loading errors
                modalAudioElement.currentTime = 0;
            }

            // Show the modal
            modal.classList.add('is-visible');
            modalContent.classList.remove('closing');
        });
    });

    // Close modal when close button is clicked
    closeModalBtn.addEventListener('click', () => {
        closeModal();
    });

    // Close modal when clicking outside of the modal content
    window.addEventListener('click', (event) => {
        if (event.target === modal) {
            closeModal();
        }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && modal.classList.contains('is-visible')) {
            closeModal();
        }
    });

    function closeModal() {
        // Pause and reset audio preview in modal before closing
        if (modalAudioElement && !modalAudioElement.paused) {
            modalAudioElement.pause();
            modalAudioElement.currentTime = 0;
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>'; // Reset play icon
            progressBar.style.width = '0%'; // Reset progress bar
            timeDisplay.textContent = '0:00 / 0:00'; // Reset time display
        }

        // Add the closing class to the content to trigger its exit animation
        modalContent.classList.add('closing');

        // Wait for the exit animation to complete before hiding the modal entirely
        modalContent.addEventListener('transitionend', handleTransitionEnd, { once: true });

        function handleTransitionEnd() {
            modal.classList.remove('is-visible'); // Hide the modal container
            modalContent.classList.remove('closing'); // Clean up the closing class
        }
    }

    // --- Custom Audio Player Functionality within Modal ---

    // Format time for display
    function formatTime(seconds) {
        const minutes = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
    }

    // Play/Pause button functionality
    playPauseBtn.addEventListener('click', () => {
        if (modalAudioElement.paused) {
            modalAudioElement.play();
            playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
        } else {
            modalAudioElement.pause();
            playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        }
    });

    // Update progress bar and time display
    modalAudioElement.addEventListener('timeupdate', () => {
        const progress = (modalAudioElement.currentTime / modalAudioElement.duration) * 100;
        progressBar.style.width = `${progress}%`;
        timeDisplay.textContent = `${formatTime(modalAudioElement.currentTime)} / ${formatTime(modalAudioElement.duration)}`;
    });

    // Update duration when metadata is loaded (fixes NaN/undefined duration initially)
    modalAudioElement.addEventListener('loadedmetadata', () => {
        timeDisplay.textContent = `0:00 / ${formatTime(modalAudioElement.duration)}`;
    });


    // Seek functionality
    progressBarContainer.addEventListener('click', (e) => {
        const clickX = e.offsetX; // X position of the click relative to the container
        const width = progressBarContainer.offsetWidth; // Total width of the progress bar container
        const duration = modalAudioElement.duration;
        modalAudioElement.currentTime = (clickX / width) * duration;
    });

    // Volume control
    volumeSlider.addEventListener('input', () => {
        modalAudioElement.volume = volumeSlider.value;
        if (modalAudioElement.volume === 0) {
            volumeIcon.classList.remove('fa-volume-up');
            volumeIcon.classList.add('fa-volume-mute');
        } else {
            volumeIcon.classList.remove('fa-volume-mute');
            volumeIcon.classList.add('fa-volume-up');
        }
    });

    // Mute/Unmute functionality
    let lastVolume = 1; // Store last volume before muting
    volumeIcon.addEventListener('click', () => {
        if (modalAudioElement.volume === 0) {
            modalAudioElement.volume = lastVolume; // Restore last volume
            volumeSlider.value = lastVolume;
            volumeIcon.classList.remove('fa-volume-mute');
            volumeIcon.classList.add('fa-volume-up');
        } else {
            lastVolume = modalAudioElement.volume; // Save current volume
            modalAudioElement.volume = 0;
            volumeSlider.value = 0;
            volumeIcon.classList.remove('fa-volume-up');
            volumeIcon.classList.add('fa-volume-mute');
        }
    });

    // Handle audio ending
    modalAudioElement.addEventListener('ended', () => {
        playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
        progressBar.style.width = '0%';
        modalAudioElement.currentTime = 0; // Reset to beginning
    });
        });

    // --- Post Modal Logic ---
    const postModal = document.getElementById('postModal');
    const closePostModalBtn = document.getElementById('closePostModalBtn');
    const postModalContent = postModal.querySelector('.modal-content');

    const modalPostImage = document.getElementById('modalPostImage');
    const modalPostTitle = document.getElementById('modalPostTitle');
    const modalPostMeta = document.getElementById('modalPostMeta');
    const modalPostDescription = document.getElementById('modalPostDescription');

    // Get all "Read more" links for posts
    const openPostModalBtns = document.querySelectorAll('.open-post-modal');

    openPostModalBtns.forEach(button => {
        button.addEventListener('click', (event) => {
            event.preventDefault(); // Prevent default link behavior

            // Get the parent post div
            const postDiv = event.target.closest('.post');

            // Populate modal content from data attributes
            modalPostImage.src = postDiv.dataset.postImage;
            modalPostTitle.textContent = postDiv.dataset.postTitle;
            modalPostMeta.textContent = `${postDiv.dataset.postArtist} - ${postDiv.dataset.postDate}`;
            modalPostDescription.textContent = postDiv.dataset.fullPostText; // Use the full text

            // Show the modal
            postModal.classList.add('is-visible');
            postModalContent.classList.remove('closing');
        });
    });

    // Close modal when close button is clicked
    closePostModalBtn.addEventListener('click', () => {
        closePostModal();
    });

    // Close modal when clicking outside of the modal content
    window.addEventListener('click', (event) => {
        if (event.target === postModal) {
            closePostModal();
        }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', (event) => {
        if (event.key === 'Escape' && postModal.classList.contains('is-visible')) {
            closePostModal();
        }
    });

    function closePostModal() {
        postModalContent.classList.add('closing');
        postModalContent.addEventListener('transitionend', handlePostTransitionEnd, { once: true });

        function handlePostTransitionEnd() {
            postModal.classList.remove('is-visible');
            postModalContent.classList.remove('closing');
            // Clear content after closing to prevent flicker on next open
            modalPostImage.src = '';
            modalPostTitle.textContent = '';
            modalPostMeta.textContent = '';
            modalPostDescription.textContent = '';
        }
    }

    // --- Share Button Logic (if you want to implement this) ---
    const shareButtons = document.querySelectorAll('.share-button');
    shareButtons.forEach(button => {
        button.addEventListener('click', () => {
            const urlToShare = button.dataset.url || window.location.href; // Use data-url or current page URL
            // Basic share functionality (can be improved with Web Share API or custom dialog)
            if (navigator.share) {
                navigator.share({
                    title: document.title,
                    url: urlToShare
                }).then(() => {
                    console.log('Thanks for sharing!');
                }).catch(console.error);
            } else {
                // Fallback for browsers that don't support Web Share API
                prompt("Copy this link to share:", urlToShare);
            }
        });
    });

    </script>

</body>
</html>